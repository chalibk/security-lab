# falco-rules/custom_sensitive.yaml
- rule: Read-Access-To-etc-shadow
  desc: Detect any process reading /etc/shadow, including inside containers
  condition: >
    evt.type in (open, openat) and fd.name endswith "/etc/shadow"
  output: >
    Suspicious read of /etc/shadow (user=%user.name pid=%proc.pid proc=%proc.name cmdline=%proc.cmdline fd=%fd.name container=%container.name container_id=%container.id)
  priority: CRITICAL
  tags: [suspicious, sensitive_file]
